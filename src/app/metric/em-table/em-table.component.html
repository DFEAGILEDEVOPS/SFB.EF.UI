<hr class="govuk-section-break govuk-section-break--l">

<table class="govuk-table em-table" id="emTable">
  <thead class="govuk-table__head">
    <tr class="govuk-table__row">
      <th scope="col" class="govuk-table__header">Rank</th>
      <th scope="col" class="govuk-table__header">School</th>
      <th scope="col" class="govuk-table__header">Local authority</th>
      <th scope="col" class="govuk-table__header govuk-table__header--numeric">Pupils</th>
      <th scope="col" class="govuk-table__header govuk-table__header--numeric">Ever6 FSM</th>
      <th scope="col" class="govuk-table__header govuk-table__header--numeric">SEN/EHCP</th>
      <th scope="col" class="govuk-table__header govuk-table__header--numeric">Income per pupil</th>
      <th scope="col" class="govuk-table__header em-table__ks2-header" *ngIf='model.phase === "Primary"'>Reading</th>
      <th scope="col" class="govuk-table__header em-table__ks2-header" *ngIf='model.phase === "Primary"'>Writing</th>
      <th scope="col" class="govuk-table__header em-table__ks2-header" *ngIf='model.phase === "Primary"'>Maths</th>
      <th scope="col" class="govuk-table__header em-table__p8-header" *ngIf='model.phase === "Secondary"'>Progress 8 score</th>
    </tr>
  </thead>
  <tbody class="govuk-table__body" [class.govuk-table__body--border]='i % 5 === 0' *ngFor='let neighbour of model.neighbourDataModels; let i = index'>
    <tr class="govuk-table__row">
      <td class="govuk-table__cell em-table-rank-cell em-table-rank-cell--{{neighbour.rank}}" rowspan="2">
        <span *ngIf='i % 5 === 0' class="em-rank-text em-rank-text--{{neighbour.rank}}">{{neighbour.rank}}</span>
      </td>
      <td class="govuk-table__cell em-table-name-cell"><a [class.table-cell-highlight]='neighbour.urn === model.urn' href="{{settings.sfbDomain}}/school/detail?urn={{neighbour.urn}}">{{neighbour.name}}</a></td>
      <td class="govuk-table__cell"><span [class.table-cell-highlight]='neighbour.localAuthority === model.localAuthority'>{{neighbour.localAuthority}}</span></td>
      <td class="govuk-table__cell govuk-table__cell--numeric">{{neighbour.pupils}}</td>
      <td class="govuk-table__cell govuk-table__cell--numeric">{{neighbour.ever6 | percent:'1.1'}} </td>
      <td class="govuk-table__cell govuk-table__cell--numeric">{{neighbour.sen | percent:'1.1'}}</td>
      <td class="govuk-table__cell govuk-table__cell--numeric">{{neighbour.incomePP | currency :'GBP':'symbol':'0.0-0'}}</td>
      <td class="govuk-table__cell em-table-ks2-reading-cell" *ngIf='model.phase === "Primary"'>
        <span class="em-table-ks2-reading-cell__text"
        [ngClass]="{
          'em-table-ks2-reading-cell__text--well-below': neighbour.progressReading <= -5 ,
          'em-table-ks2-reading-cell__text--below': neighbour.progressReading > -5 && neighbour.progressReading < -0.25,
          'em-table-ks2-reading-cell__text--average': neighbour.progressReading >= -0.25 && neighbour.progressReading <= 0.25,
          'em-table-ks2-reading-cell__text--above': neighbour.progressReading < 5 && neighbour.progressReading > 0.25,
          'em-table-ks2-reading-cell__text--well-above': neighbour.progressReading >= 5}">
          {{neighbour.progressReading | number: '1.2-2' }}
        </span>
      </td>
      <td  class="govuk-table__cell em-table-ks2-writing-cell" *ngIf='model.phase === "Primary"'>
        <span class="em-table-ks2-writing-cell__text"
        [ngClass]="{
          'em-table-ks2-reading-cell__text--well-below': neighbour.progressWriting <= -5 ,
          'em-table-ks2-reading-cell__text--below': neighbour.progressWriting > -5 && neighbour.progressWriting < -0.25,
          'em-table-ks2-reading-cell__text--average': neighbour.progressWriting >= -0.25 && neighbour.progressWriting <= 0.25,
          'em-table-ks2-reading-cell__text--above': neighbour.progressWriting < 5 && neighbour.progressWriting > 0.25,
          'em-table-ks2-reading-cell__text--well-above': neighbour.progressWriting >= 5}">
          {{neighbour.progressWriting | number: '1.2-2'}}
        </span>
      </td>
      <td  class="govuk-table__cell em-table-ks2-maths-cell" *ngIf='model.phase === "Primary"'>
        <span class="em-table-ks2-maths-cell__text"
        [ngClass]="{
          'em-table-ks2-reading-cell__text--well-below': neighbour.progressMaths <= -5 ,
          'em-table-ks2-reading-cell__text--below': neighbour.progressMaths > -5 && neighbour.progressMaths < -0.25,
          'em-table-ks2-reading-cell__text--average': neighbour.progressMaths >= -0.25 && neighbour.progressMaths <= 0.25,
          'em-table-ks2-reading-cell__text--above': neighbour.progressMaths < 5 && neighbour.progressMaths > 0.25,
          'em-table-ks2-reading-cell__text--well-above': neighbour.progressMaths >= 5}">
          {{neighbour.progressMaths | number: '1.2-2'}}
        </span>
      </td>
      <td  class="govuk-table__cell em-table-p8-cell" *ngIf='model.phase === "Secondary"'>
        <span class="em-table-p8-cell__text"
        [ngClass]="{
        'em-table-p8-cell__text--well-below': neighbour.progress8 <= -5 ,
        'em-table-p8-cell__text--below': neighbour.progress8 > -5 && neighbour.progress8 < -0.25,
        'em-table-p8-cell__text--average': neighbour.progress8 >= -0.25 && neighbour.progress8 <= 0.25,
        'em-table-p8-cell__text--above': neighbour.progress8 < 5 && neighbour.progress8 > 0.25,
        'em-table-p8-cell__text--well-above': neighbour.progress8 >= 5}">
          {{neighbour.progress8 | number: '1.2-2'}}
        </span>
      </td>
    </tr>
    <tr *ngIf='neighbour.urn === model.urn'>
      <td class="govuk-table__cell link-cell" colspan="6">
        <div class="improve-link-wrapper">
          <a routerLink='/efficiency-metric/ways-to-improve/{{neighbour.urn}}/{{neighbour.name}}'>See ways to improve your school's efficiency metric ranking</a>
        </div>
      </td>
      <td class="govuk-table__cell link-cell em-table-ks2-reading-cell" *ngIf='model.phase === "Primary"'></td>
      <td class="govuk-table__cell link-cell em-table-p8-cell" *ngIf='model.phase === "Primary"'></td>
      <td class="govuk-table__cell link-cell em-table-p8-cell" *ngIf='model.phase === "Primary"'></td>
      <td class="govuk-table__cell link-cell em-table-p8-cell" *ngIf='model.phase === "Secondary"'></td>
    </tr>
  </tbody>
</table>
